{"ast":null,"code":"import _objectSpread from\"/var/www/bewanted/bewanted/bewanted/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useReducer,useEffect}from'react';import api from'../services/api';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext();// Action types\nconst AUTH_ACTIONS={LOGIN_START:'LOGIN_START',LOGIN_SUCCESS:'LOGIN_SUCCESS',LOGIN_FAILURE:'LOGIN_FAILURE',LOGOUT:'LOGOUT',SET_USER:'SET_USER',CLEAR_ERROR:'CLEAR_ERROR'};// Initial state\nconst initialState={user:null,token:localStorage.getItem('token'),isAuthenticated:false,loading:true,error:null};// Reducer function\nconst authReducer=(state,action)=>{switch(action.type){case AUTH_ACTIONS.LOGIN_START:return _objectSpread(_objectSpread({},state),{},{loading:true,error:null});case AUTH_ACTIONS.LOGIN_SUCCESS:return _objectSpread(_objectSpread({},state),{},{user:action.payload.user,token:action.payload.token,isAuthenticated:true,loading:false,error:null});case AUTH_ACTIONS.LOGIN_FAILURE:return _objectSpread(_objectSpread({},state),{},{user:null,token:null,isAuthenticated:false,loading:false,error:action.payload});case AUTH_ACTIONS.LOGOUT:return _objectSpread(_objectSpread({},state),{},{user:null,token:null,isAuthenticated:false,loading:false,error:null});case AUTH_ACTIONS.SET_USER:return _objectSpread(_objectSpread({},state),{},{user:action.payload,isAuthenticated:true,loading:false});case AUTH_ACTIONS.CLEAR_ERROR:return _objectSpread(_objectSpread({},state),{},{error:null});default:return state;}};// Auth Provider Component\nexport const AuthProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(authReducer,initialState);// Check if user is logged in on app start\nuseEffect(()=>{const checkAuthStatus=async()=>{const token=localStorage.getItem('token');if(token){try{const response=await api.get('/auth/me');dispatch({type:AUTH_ACTIONS.SET_USER,payload:response.data.data});}catch(error){console.error('Auth check failed:',error);localStorage.removeItem('token');dispatch({type:AUTH_ACTIONS.LOGOUT});}}else{dispatch({type:AUTH_ACTIONS.LOGOUT});}};checkAuthStatus();},[]);// Login function\nconst login=async(email,password)=>{try{dispatch({type:AUTH_ACTIONS.LOGIN_START});const response=await api.post('/auth/login',{email,password});const{data}=response.data;localStorage.setItem('token',data.token);dispatch({type:AUTH_ACTIONS.LOGIN_SUCCESS,payload:{user:data,token:data.token}});return{success:true,data};}catch(error){var _error$response,_error$response$data;const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Login failed';dispatch({type:AUTH_ACTIONS.LOGIN_FAILURE,payload:errorMessage});return{success:false,error:errorMessage};}};// Register function\nconst register=async(name,email,password)=>{try{dispatch({type:AUTH_ACTIONS.LOGIN_START});const response=await api.post('/auth/register',{name,email,password});const{data}=response.data;localStorage.setItem('token',data.token);dispatch({type:AUTH_ACTIONS.LOGIN_SUCCESS,payload:{user:data,token:data.token}});return{success:true,data};}catch(error){var _error$response2,_error$response2$data;const errorMessage=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Registration failed';dispatch({type:AUTH_ACTIONS.LOGIN_FAILURE,payload:errorMessage});return{success:false,error:errorMessage};}};// Logout function\nconst logout=()=>{localStorage.removeItem('token');dispatch({type:AUTH_ACTIONS.LOGOUT});};// Update user profile\nconst updateProfile=async profileData=>{try{const response=await api.put('/auth/profile',profileData);dispatch({type:AUTH_ACTIONS.SET_USER,payload:response.data.data});return{success:true,data:response.data.data};}catch(error){var _error$response3,_error$response3$data;const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||'Profile update failed';return{success:false,error:errorMessage};}};// Clear error\nconst clearError=()=>{dispatch({type:AUTH_ACTIONS.CLEAR_ERROR});};const value={user:state.user,token:state.token,isAuthenticated:state.isAuthenticated,loading:state.loading,error:state.error,login,register,logout,updateProfile,clearError};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};// Custom hook to use auth context\nexport const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};export default AuthContext;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}